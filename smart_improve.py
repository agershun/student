#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–£–ú–ù–û–ï —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ç–µ—Ö–Ω–∏–∫ –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–∞
–°–æ–∑–¥–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
"""

import re
import random

# –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
with open('/Users/agershun/repo/ag/student/index.html', 'r', encoding='utf-8') as f:
    content = f.read()

# –ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤
pattern = r'(<div class="prompt-card visible" data-category="([^"]+)") data-prompt="([^"]+)">(\s*<h3>)([^<]+)(</h3>\s*<p>)([^<]+)(</p>)'

# –ù–∞–π–¥–µ–º –≤—Å–µ –ø—Ä–æ–º–ø—Ç—ã
matches = list(re.finditer(pattern, content, re.DOTALL))
print(f"–ù–∞–π–¥–µ–Ω–æ {len(matches)} –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è")

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–º–ø—Ç–∞ –ø–æ –ø–æ–∑–∏—Ü–∏–∏
def get_prompt_level(index, section_size=100):
    """
    –í –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–∏ (100 –ø—Ä–æ–º–ø—Ç–æ–≤):
    - –ò–Ω–¥–µ–∫—Å—ã 0-29: –±–∞–∑–æ–≤—ã–µ (30%)
    - –ò–Ω–¥–µ–∫—Å—ã 30-69: —Å—Ä–µ–¥–Ω–∏–µ (40%)
    - –ò–Ω–¥–µ–∫—Å—ã 70-99: –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ (30%)
    """
    position_in_section = index % section_size
    if position_in_section < 30:
        return "basic"
    elif position_in_section < 70:
        return "medium"
    else:
        return "advanced"

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–º–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞
def smart_improve(current_prompt, title, category, level):
    """
    –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ç–µ—Ö–Ω–∏–∫–∏ –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
    """

    # –ï—Å–ª–∏ –ø—Ä–æ–º–ø—Ç —É–∂–µ —É–ª—É—á—à–µ–Ω, –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
    if any(kw in current_prompt for kw in ['–ö–û–ù–¢–ï–ö–°–¢:', '–ó–ê–î–ê–ß–ê:', '–§–û–†–ú–ê–¢:', '–¢–í–û–Ø –†–û–õ–¨:', '–ü–†–û–¶–ï–°–°:', '–ú–ï–¢–û–î:']):
        return current_prompt, current_prompt.split('.')[0] + '.' if '.' in current_prompt else current_prompt[:150]

    # –ë–ê–ó–û–í–´–ï –ü–†–û–ú–ü–¢–´ - –∫–æ—Ä–æ—Ç–∫–∏–µ, –Ω–æ —Å —É—Ç–æ—á–Ω–µ–Ω–∏—è–º–∏
    if level == "basic":
        # –û—á–∏—â–∞–µ–º –ø—Ä–æ–º–ø—Ç
        base = current_prompt.rstrip('. ')

        # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ–∑–Ω—ã–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è
        additions = []

        if any(word in current_prompt.lower() for word in ['–æ–±—ä—è—Å–Ω–∏', '—Ä–∞—Å—Å–∫–∞–∂–∏', '–æ–ø–∏—à–∏']):
            additions.append("–ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Å—Ç–æ–π —è–∑—ã–∫ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã")
        if any(word in current_prompt.lower() for word in ['—Å–æ–∑–¥–∞–π', '—Å–æ—Å—Ç–∞–≤—å', '–Ω–∞–ø–∏—à–∏']):
            additions.append("–°–¥–µ–ª–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –ª–µ–≥–∫–∏–º –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è")
        if any(word in current_prompt.lower() for word in ['–ø–æ–º–æ–≥–∏', '–¥–∞–π —Å–æ–≤–µ—Ç']):
            additions.append("–î–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ—à–∞–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏")
        if '—Å–ø–∏—Å–æ–∫' in current_prompt.lower():
            additions.append("–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä—É–π –ø—É–Ω–∫—Ç—ã –æ—Ç –≤–∞–∂–Ω–æ–≥–æ –∫ –º–µ–Ω–µ–µ –≤–∞–∂–Ω–æ–º—É")

        if additions:
            improved = f"{base}. {'. '.join(additions)}."
        else:
            improved = f"{base}. –î–∞–π —á–µ—Ç–∫–∏–π –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏."

        desc = base + '.'
        return improved, desc

    # –°–†–ï–î–ù–ò–ï –ü–†–û–ú–ü–¢–´ - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
    elif level == "medium":
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∑–∞–¥–∞—á–∏
        task_type = "–æ–±—â–∞—è"
        if any(word in current_prompt.lower() for word in ['–ø–ª–∞–Ω', '—Å—Ç—Ä—É–∫—Ç—É—Ä', '—Å—Ö–µ–º', '—Ä–∞—Å–ø–∏—Å–∞–Ω']):
            task_type = "–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"
        elif any(word in current_prompt.lower() for word in ['–æ–±—ä—è—Å–Ω–∏', '—Ä–∞–∑–±–µ—Ä', '–ø–æ–π–º–∏']):
            task_type = "–æ–±—É—á–µ–Ω–∏–µ"
        elif any(word in current_prompt.lower() for word in ['—Å–æ–∑–¥–∞', '—Å–æ—Å—Ç–∞–≤—å', '–Ω–∞–ø–∏—à–∏']):
            task_type = "—Å–æ–∑–¥–∞–Ω–∏–µ"
        elif any(word in current_prompt.lower() for word in ['–∞–Ω–∞–ª–∏–∑', '–æ—Ü–µ–Ω', '–ø—Ä–æ–≤–µ—Ä']):
            task_type = "–∞–Ω–∞–ª–∏–∑"

        # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç
        if task_type == "–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ":
            improved = f"""–ó–ê–î–ê–ß–ê:
{current_prompt}

–ß–¢–û –ù–£–ñ–ù–û –í–ö–õ–Æ–ß–ò–¢–¨:
1. –ß–µ—Ç–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–ª–∞–Ω–∞
2. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—é —ç–ª–µ–º–µ–Ω—Ç–æ–≤
3. –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
4. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —à–∞–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π

–§–û–†–ú–ê–¢: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏."""

        elif task_type == "–æ–±—É—á–µ–Ω–∏–µ":
            improved = f"""–¢–ï–ú–ê –î–õ–Ø –ò–ó–£–ß–ï–ù–ò–Ø:
{current_prompt}

–ü–û–î–•–û–î –ö –û–ë–™–Ø–°–ù–ï–ù–ò–Æ:
1. –ù–∞—á–Ω–∏ —Å –ø—Ä–æ—Å—Ç–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
2. –û–±—ä—è—Å–Ω–∏ –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
3. –ü—Ä–∏–≤–µ–¥–∏ 2-3 –Ω–∞–≥–ª—è–¥–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞
4. –ü–æ–∫–∞–∂–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π –∞–Ω–∞–ª–æ–≥–∏–∏ –∏ –ø—Ä–æ—Å—Ç–æ–π —è–∑—ã–∫."""

        elif task_type == "—Å–æ–∑–¥–∞–Ω–∏–µ":
            improved = f"""–ó–ê–î–ê–ß–ê:
{current_prompt}

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏ –¥–µ—Ç–∞–ª–∏
- –ü—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å
- –ß–µ—Ç–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

–°–¥–µ–ª–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–æ—Ç–æ–≤—ã–º –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é."""

        elif task_type == "–∞–Ω–∞–ª–∏–∑":
            improved = f"""–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
{current_prompt}

–ü–†–û–¶–ï–°–°:
1. –ò–∑—É—á–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
2. –í—ã–¥–µ–ª–∏ –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã
3. –û—Ü–µ–Ω–∏ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º
4. –î–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–§–û–†–ú–ê–¢: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Å –≤—ã–≤–æ–¥–∞–º–∏."""

        else:
            improved = f"""–ó–ê–î–ê–ß–ê:
{current_prompt}

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –î–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
- –ü—Ä–∏–≤–µ–¥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã
- –û–±—ä—è—Å–Ω–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
- –£–∫–∞–∂–∏ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç–∏ –∏ –¥–µ–π—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ —Å–æ–≤–µ—Ç–æ–≤."""

        desc = f"{current_prompt.split('.')[0]}. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏." if '.' in current_prompt else improved.split('\n')[1]
        return improved, desc

    # –ü–†–û–î–í–ò–ù–£–¢–´–ï –ü–†–û–ú–ü–¢–´ - —Å —Ä–æ–ª—å—é –∏ –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
    else:  # advanced
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–¥—Ö–æ–¥—è—â—É—é —Ä–æ–ª—å
        role = "–¢—ã - –æ–ø—ã—Ç–Ω—ã–π —ç–∫—Å–ø–µ—Ä—Ç –∏ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫"

        if any(word in title.lower() + current_prompt.lower() for word in ['–ø—Ä–µ–ø–æ–¥', '—É—á–∏—Ç–µ–ª—å', '–æ–±—É—á', '—ç–∫–∑–∞–º–µ–Ω', '–ª–µ–∫—Ü']):
            role = "–¢—ã - –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ —Å 10-–ª–µ—Ç–Ω–∏–º —Å—Ç–∞–∂–µ–º"
        elif any(word in title.lower() + current_prompt.lower() for word in ['–∫–∞—Ä—å–µ—Ä', '—Ä–µ–∑—é–º–µ', '—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω', '—Ä–∞–±–æ—Ç', '–≤–∞–∫–∞–Ω']):
            role = "–¢—ã - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞—Ä—å–µ—Ä–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –Ω–∞ –º–æ–ª–æ–¥—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞—Ö"
        elif any(word in title.lower() + current_prompt.lower() for word in ['–Ω–∞—É—á–Ω', '–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω', '—Å—Ç–∞—Ç—å—è', '–¥–∏–ø–ª–æ–º', '–∫—É—Ä—Å–æ–≤']):
            role = "–¢—ã - –Ω–∞—É—á–Ω—ã–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –∏ –º–µ—Ç–æ–¥–æ–ª–æ–≥ —Å –æ–ø—ã—Ç–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏"
        elif any(word in title.lower() + current_prompt.lower() for word in ['–ø—Å–∏—Ö–æ–ª–æ–≥', '—Å—Ç—Ä–µ—Å—Å', '–º–æ—Ç–∏–≤–∞—Ü', '—ç–º–æ—Ü–∏']):
            role = "–¢—ã - –ø—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–π –ø—Å–∏—Ö–æ–ª–æ–≥-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤"
        elif any(word in title.lower() + current_prompt.lower() for word in ['–ø—Ä–æ–µ–∫—Ç', '–ø–ª–∞–Ω', '–æ—Ä–≥–∞–Ω–∏–∑']):
            role = "–¢—ã - –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä –∏ –º–µ—Ç–æ–¥–æ–ª–æ–≥"
        elif any(word in title.lower() + current_prompt.lower() for word in ['–±—é–¥–∂–µ—Ç', '—Ñ–∏–Ω–∞–Ω—Å', '–¥–µ–Ω—å–≥']):
            role = "–¢—ã - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –Ω–∞ –ª–∏—á–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–∞—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤"

        improved = f"""{role}.

–ö–û–ù–¢–ï–ö–°–¢:
{current_prompt}

–¢–í–û–Ø –ó–ê–î–ê–ß–ê:
1. –ì–ª—É–±–æ–∫–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–∏—Ç—É–∞—Ü–∏—é
2. –ü—Ä–∏–º–µ–Ω–∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏–∑ —Å–≤–æ–µ–≥–æ –æ–ø—ã—Ç–∞
3. –î–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, actionable —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
4. –û–±—ä—è—Å–Ω–∏ –ª–æ–≥–∏–∫—É –∑–∞ –∫–∞–∂–¥—ã–º —Å–æ–≤–µ—Ç–æ–º
5. –ü—Ä–µ–¥–ª–æ–∂–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê:
- –ê–Ω–∞–ª–∏–∑ —Å–∏—Ç—É–∞—Ü–∏–∏
- –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏ —à–∞–±–ª–æ–Ω—ã
- –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

–í–ê–ñ–ù–û:
- –ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º, –∏–∑–±–µ–≥–∞–π –æ–±—â–∏—Ö —Ñ—Ä–∞–∑
- –ê–¥–∞–ø—Ç–∏—Ä—É–π —Å–æ–≤–µ—Ç—ã –ø–æ–¥ —Ä–æ—Å—Å–∏–π—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –î–∞–≤–∞–π –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ä–∞–∑—É"""

        desc = f"{role}. {current_prompt.split('.')[0] if '.' in current_prompt else current_prompt[:120]}. –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏."
        return improved, desc

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–æ–º–ø—Ç—ã
new_content = content
stats = {
    'students': {'basic': 0, 'medium': 0, 'advanced': 0},
    'teachers': {'basic': 0, 'medium': 0, 'advanced': 0},
    'home': {'basic': 0, 'medium': 0, 'advanced': 0}
}

current_section = None
section_index = -1

for i, match in enumerate(matches):
    category = match.group(2)

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–µ–∫—Ü–∏—é
    if i < 100:
        current_section = 'students'
        section_index = i
    elif i < 200:
        current_section = 'teachers'
        section_index = i - 100
    else:
        current_section = 'home'
        section_index = i - 200

    level = get_prompt_level(section_index)

    opening_div = match.group(1)
    current_prompt = match.group(3)
    h3_open = match.group(4)
    title = match.group(5)
    h3_close_p_open = match.group(6)
    old_description = match.group(7)
    p_close = match.group(8)

    # –£–ª—É—á—à–∞–µ–º –ø—Ä–æ–º–ø—Ç
    improved_prompt, new_description = smart_improve(current_prompt, title, category, level)

    # –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É
    old_card = match.group(0)
    new_card = f'{opening_div} data-prompt="{improved_prompt}">{h3_open}{title}{h3_close_p_open}{new_description}{p_close}'

    # –ó–∞–º–µ–Ω—è–µ–º –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ)
    new_content = new_content.replace(old_card, new_card, 1)

    stats[current_section][level] += 1

    if (i + 1) % 50 == 0:
        print(f"‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {i + 1}/300 –ø—Ä–æ–º–ø—Ç–æ–≤...")

# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
with open('/Users/agershun/repo/ag/student/index.html', 'w', encoding='utf-8') as f:
    f.write(new_content)

print(f"\n{'='*60}")
print(f"‚úÖ –£–õ–£–ß–®–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û –£–°–ü–ï–®–ù–û!")
print(f"{'='*60}\n")

print("–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –†–ê–ó–î–ï–õ–ê–ú:\n")

for section, counts in stats.items():
    section_names = {'students': '–°–¢–£–î–ï–ù–¢–´', 'teachers': '–ü–†–ï–ü–û–î–ê–í–ê–¢–ï–õ–ò', 'home': '–î–û–ú'}
    print(f"üìö {section_names[section]}:")
    print(f"   - –ë–∞–∑–æ–≤—ã–µ (basic):      {counts['basic']} –ø—Ä–æ–º–ø—Ç–æ–≤")
    print(f"   - –°—Ä–µ–¥–Ω–∏–µ (medium):     {counts['medium']} –ø—Ä–æ–º–ø—Ç–æ–≤")
    print(f"   - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ (advanced): {counts['advanced']} –ø—Ä–æ–º–ø—Ç–æ–≤")
    print(f"   - –í–°–ï–ì–û:                {sum(counts.values())} –ø—Ä–æ–º–ø—Ç–æ–≤\n")

total = sum(sum(counts.values()) for counts in stats.values())
print(f"{'='*60}")
print(f"–ò–¢–û–ì–û –û–ë–†–ê–ë–û–¢–ê–ù–û: {total} –ø—Ä–æ–º–ø—Ç–æ–≤")
print(f"{'='*60}\n")

print(f"üìÅ –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: /Users/agershun/repo/ag/student/index.html")
print(f"üìÅ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è: /Users/agershun/repo/ag/student/index.html.backup")
